# ==============================================================================
# Algo-Trade System - Environment Variables Template
# ==============================================================================
# INSTRUCTIONS:
# 1. Copy this file to .env: cp .env.example .env
# 2. Fill in your actual values
# 3. NEVER commit .env to git (it's in .gitignore)
# ==============================================================================

# ------------------------------------------------------------------------------
# ENVIRONMENT
# ------------------------------------------------------------------------------
ENVIRONMENT=development  # development | staging | production
LOG_LEVEL=INFO          # DEBUG | INFO | WARNING | ERROR | CRITICAL

# ------------------------------------------------------------------------------
# IBKR (Interactive Brokers) Configuration
# ------------------------------------------------------------------------------
# TWS/Gateway Connection
IBKR_HOST=127.0.0.1
IBKR_PORT=4002          # 4002 (paper) | 4001 (live) for Gateway
                        # 7497 (paper) | 7496 (live) for TWS
IBKR_CLIENT_ID=1        # Unique ID (1-32)
IBKR_ACCOUNT=DU1234567  # Paper: DU* | Live: U*
IBKR_TIMEOUT=10         # Connection timeout (seconds)
IBKR_READ_ONLY=true     # true (Stage 6) | false (Stage 7+)

# IBKR Authentication (Live Only - DO NOT fill for paper trading)
# WARNING: These should be loaded from Vault in production
IBKR_USERNAME=          # Your IBKR username (leave empty for paper)
IBKR_PASSWORD=          # Your IBKR password (leave empty for paper)
IBKR_API_KEY=           # Your API key (if using WebAPI)

# ------------------------------------------------------------------------------
# KAFKA Configuration
# ------------------------------------------------------------------------------
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_CONSUMER_GROUP=algo_trade_consumer
KAFKA_AUTO_OFFSET_RESET=earliest  # earliest | latest
KAFKA_BATCH_SIZE=1000
KAFKA_LINGER_MS=10
KAFKA_COMPRESSION_TYPE=gzip       # none | gzip | snappy | lz4 | zstd

# Kafka Topics
KAFKA_TOPIC_MARKET_EVENTS=market_events
KAFKA_TOPIC_ORDER_INTENTS=order_intents
KAFKA_TOPIC_EXEC_REPORTS=exec_reports

# ------------------------------------------------------------------------------
# SECRETS MANAGEMENT (HashiCorp Vault)
# ------------------------------------------------------------------------------
# Enable Vault integration (1=enabled, 0=disabled)
DP_USE_VAULT=0

# Vault server configuration
VAULT_ADDR=http://localhost:8200
VAULT_TOKEN=your-vault-token-here
VAULT_NAMESPACE=                  # Optional: Vault namespace

# Vault paths for secrets
DP_VAULT_PATH=secret/data/algo-trade/data-plane
DP_VAULT_PATH_PASSWORD=secret/data/algo-trade/ibkr/password

# ------------------------------------------------------------------------------
# SECRETS MANAGEMENT (AWS Secrets Manager)
# ------------------------------------------------------------------------------
# Enable AWS Secrets Manager (alternative to Vault)
USE_AWS_SECRETS=false

# AWS Configuration
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=                # Leave empty to use IAM role
AWS_SECRET_ACCESS_KEY=            # Leave empty to use IAM role
AWS_SECRET_NAME=algo-trade/production

# ------------------------------------------------------------------------------
# DATABASE Configuration (if using persistence)
# ------------------------------------------------------------------------------
DB_HOST=localhost
DB_PORT=5432
DB_NAME=algo_trade
DB_USER=algo_trade_user
DB_PASSWORD=                      # LOAD FROM VAULT IN PRODUCTION

# ------------------------------------------------------------------------------
# MONITORING & OBSERVABILITY
# ------------------------------------------------------------------------------
# Prometheus
PROMETHEUS_PORT=8000
PROMETHEUS_METRICS_PATH=/metrics

# Grafana
GRAFANA_URL=http://localhost:3000
GRAFANA_API_KEY=                  # API key for dashboards

# AlertManager
ALERTMANAGER_URL=http://localhost:9093

# ------------------------------------------------------------------------------
# DATA PLANE Configuration
# ------------------------------------------------------------------------------
# Override config via environment variables (prefix: DP_)
# Nesting: Use double underscore (__) for nested keys
# Example: DP_broker__host=127.0.0.1

DP_broker__name=IBKR
DP_broker__host=${IBKR_HOST}
DP_broker__port=${IBKR_PORT}
DP_broker__paper=true

# ------------------------------------------------------------------------------
# RISK MANAGEMENT
# ------------------------------------------------------------------------------
# Kill-Switch Parameters (from algo_trade/core/config.py)
KILL_PNL_THRESHOLD=-0.05          # -5% daily PnL
MAX_DRAWDOWN_THRESHOLD=0.15       # 15% max drawdown
MIN_PSR_THRESHOLD=0.20            # Minimum Probabilistic Sharpe Ratio

# Position Limits
MAX_POSITION_SIZE=10000           # Max position size per asset
MAX_GROSS_EXPOSURE=1.0            # 100% of NAV
MAX_NET_EXPOSURE=0.5              # 50% of NAV

# Box constraints
BOX_LIM_LOWER=-0.10               # -10% per asset
BOX_LIM_UPPER=0.10                # +10% per asset

# ------------------------------------------------------------------------------
# BACKTESTING & VALIDATION
# ------------------------------------------------------------------------------
BACKTEST_START_DATE=2020-01-01
BACKTEST_END_DATE=2023-12-31
BACKTEST_INITIAL_CAPITAL=100000

# Cross-validation
CSCV_NUM_PATHS=1000               # Combinatorially-Symmetric CV paths
CSCV_TRAIN_RATIO=0.70

# ------------------------------------------------------------------------------
# PERFORMANCE TUNING
# ------------------------------------------------------------------------------
# Signal computation
SIGNAL_FREQ_SEC=60                # Signal frequency (seconds)
SIGNAL_LOOKBACK_DAYS=252          # Historical data window

# Order execution
MAX_CONCURRENT_ORDERS=10
ORDER_TIMEOUT_SEC=30

# Data retention
DATA_RETENTION_DAYS=365

# ------------------------------------------------------------------------------
# DEVELOPMENT & TESTING
# ------------------------------------------------------------------------------
# Feature flags
ENABLE_PAPER_TRADING=true
ENABLE_BACKTESTING=false
ENABLE_LIVE_TRADING=false

# Test configuration
TEST_MODE=false
TEST_SEEDS_FILE=fixtures/seeds.yaml
TEST_FAST_MODE=false              # Skip slow tests

# ------------------------------------------------------------------------------
# SECURITY
# ------------------------------------------------------------------------------
# API authentication (if exposing REST API)
API_SECRET_KEY=                   # Generate with: openssl rand -hex 32
JWT_ALGORITHM=HS256
JWT_EXPIRATION_MINUTES=30

# CORS (if using web interface)
CORS_ORIGINS=http://localhost:3000,http://localhost:8080

# ------------------------------------------------------------------------------
# LOGGING & DEBUGGING
# ------------------------------------------------------------------------------
LOG_FORMAT=json                   # json | text
LOG_FILE_PATH=logs/algo_trade.log
LOG_FILE_MAX_BYTES=10485760       # 10MB
LOG_FILE_BACKUP_COUNT=5

# Debug mode
DEBUG=false
VERBOSE_LOGGING=false

# ------------------------------------------------------------------------------
# CONTACT & ALERTING
# ------------------------------------------------------------------------------
# Email alerts (for incidents)
EMAIL_ENABLED=false
EMAIL_SMTP_HOST=smtp.gmail.com
EMAIL_SMTP_PORT=587
EMAIL_USERNAME=
EMAIL_PASSWORD=                   # Use app-specific password
EMAIL_FROM=alerts@algo-trade.com
EMAIL_TO=oncall@yourcompany.com

# Slack alerts
SLACK_ENABLED=false
SLACK_WEBHOOK_URL=

# PagerDuty (for critical alerts)
PAGERDUTY_ENABLED=false
PAGERDUTY_API_KEY=
PAGERDUTY_SERVICE_KEY=

# ==============================================================================
# END OF CONFIGURATION
# ==============================================================================
# For production deployment, use:
# - HashiCorp Vault for secrets management
# - AWS Secrets Manager as alternative
# - Kubernetes Secrets for container orchestration
# See SECRETS_MANAGEMENT.md for detailed setup instructions
# ==============================================================================
